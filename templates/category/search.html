{% extends 'base.html' %}

{% block content %}
<style>
    body {
        background: linear-gradient(180deg, #f8f9ff, #f1f3ff);
        font-family: 'Inter', sans-serif;
    }

    .jobs-wrapper {
        max-width: 1100px;
        margin: auto;
    }

    /* Search Box */
    .search-box {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(8px);
        border-radius: 20px;
        padding: 22px;
        border: 1px solid #e8e8ff;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
    }

    .search-box input {
        border-radius: 14px;
        padding: 14px 18px;
        font-size: 15px;
    }

    .search-box button {
        border-radius: 14px;
        padding: 14px 32px;
        font-weight: 600;
    }

    /* Results Header */
    .results-header {
        background: linear-gradient(135deg, #5f6cff, #8f6aff);
        color: white;
        border-radius: 20px;
        padding: 24px;
        margin-bottom: 28px;
        box-shadow: 0 15px 30px rgba(95, 108, 255, 0.3);
    }

    .results-header h4 {
        font-weight: 700;
        font-size: 22px;
    }

    /* Job Card */
    .job-card {
        background: white;
        border-radius: 22px;
        padding: 26px;
        border: 1px solid #ececff;
        margin-bottom: 18px;
        transition: all .35s ease;
        position: relative;
        overflow: hidden;
    }

    .job-card::before {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(120deg, transparent, rgba(95, 108, 255, .08), transparent);
        opacity: 0;
        transition: .3s;
        pointer-events: none;
    }

    .job-card:hover::before {
        opacity: 1;
    }

    .job-card:hover {
        transform: translateY(-6px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
        border-color: #5f6cff;
    }

    .job-title {
        font-weight: 700;
        font-size: 21px;
        color: #1f1f1f;
        margin-bottom: 10px;
    }

    .company-name {
        color: #5f6cff;
        font-weight: 600;
        font-size: 15px;
        display: flex;
        gap: 6px;
        align-items: center;
    }

    .location-text {
        color: #7b7b7b;
        font-size: 14px;
        margin-bottom: 14px;
    }

    .salary-badge {
        background: linear-gradient(135deg, #d1f4e0, #bdf1d4);
        color: #0a7c3e;
        padding: 8px 18px;
        border-radius: 12px;
        font-weight: 600;
        font-size: 14px;
    }

    /* Buttons */
    .btn-view {
        background: linear-gradient(135deg, #5f6cff, #7b6cff);
        color: white;
        border-radius: 14px;
        padding: 10px 26px;
        font-weight: 600;
        border: none;
        text-decoration: none;
        transition: .25s;
    }

    .btn-view:hover {
        opacity: .9;
        transform: scale(1.05);
    }

    .btn-delete {
        background: transparent;
        color: #ff4d4f;
        border: 2px solid #ff4d4f;
        border-radius: 14px;
        padding: 8px 20px;
        font-weight: 600;
        transition: .25s;
    }

    .btn-delete:hover {
        background: #ff4d4f;
        color: white;
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 70px 20px;
        background: white;
        border-radius: 22px;
        border: 1px dashed #dcdcff;
    }

    .empty-state-icon {
        font-size: 70px;
        margin-bottom: 20px;
    }

    .filter-btn {
        padding: 10px 18px;
        border-radius: 14px;
        background: white;
        border: 1px solid #e0e0ff;
        color: #5f6cff;
        font-weight: 600;
        text-decoration: none;
        transition: .25s;
        font-size: 14px;
    }

    .filter-btn:hover {
        background: #5f6cff;
        color: white;
    }

    .filter-btn.active {
        background: linear-gradient(135deg, #5f6cff, #7b6cff);
        color: white;
        box-shadow: 0 8px 20px rgba(95, 108, 255, 0.3);
    }


    /* Responsive */
    @media (max-width: 768px) {
        .job-card>div {
            flex-direction: column !important;
            gap: 18px;
        }
    }
</style>


<div class="container py-5 jobs-wrapper">

    <!-- Search Bar -->
    <div class="search-box mb-4">
        <form method="GET" action="{% url 'search' %}">
            <div class="input-group">
                <input type="text" class="form-control border-end-0"
                    placeholder="ğŸ” Kasb nomi, kompaniya yoki kalit so'z..." name="q" value="{{ query }}">
                <button class="btn btn-primary" type="submit">Qidirish</button>
            </div>
        </form>
    </div>

    <!-- Date Filters -->
    <div class="d-flex gap-2 mb-4 flex-wrap">
        <a href="?date=today{% if query %}&q={{ query }}{% endif %}"
            class="filter-btn {% if request.GET.date == 'today' %}active{% endif %}">
            ğŸŸ¢ Bugungi ishlar
        </a>

        <a href="?date=yesterday{% if query %}&q={{ query }}{% endif %}"
            class="filter-btn {% if request.GET.date == 'yesterday' %}active{% endif %}">
            ğŸŸ¡ Kechagi ishlar
        </a>

        <a href="{% url 'search' %}{% if query %}?q={{ query }}{% endif %}"
            class="filter-btn {% if not request.GET.date %}active{% endif %}">
            ğŸ”µ Barchasi
        </a>
    </div>


    <!-- Results Header -->
    <div class="results-header">
        <h4>ğŸ“‹ Natijalar: {{ jobs.count }} ta ish topildi</h4>
    </div>

    <!-- Job List -->
    {% for job in jobs %}
    <div class="job-card">
        <div class="d-flex justify-content-between align-items-start">

            <div class="flex-grow-1">
                <h5 class="job-title">{{ job.title|default:"Sarlovha mavjud emas"|truncatewords:10 }}</h5>

                <p class="company-name">
                    <svg width="16" height="16" fill="currentColor" class="bi bi-building" viewBox="0 0 16 16">
                        <path
                            d="M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1ZM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Z" />
                        <path
                            d="M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V1Zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3V1Z" />
                    </svg>
                    {{ job.employer.company_name }}
                </p>

                <p class="location-text">
                    <i class="bi bi-geo-alt-fill"></i> {{ job.location }}
                </p>

                <span class="salary-badge">
                    ğŸ’° {{ job.salary|default:"Kelishiladi" }}
                </span>
            </div>

            <div class="action-buttons">
                <a href="{% url 'job:job-detail' job.pk %}" class="btn-view">
                    Ko'rish â†’
                </a>
                {% if request.user.is_superuser %}
                <form method="post" action="{% url 'job_delete' job.pk %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn-delete"
                        onclick="return confirm('Rostdan ham o\'chirmoqchimisiz?');">
                        O'chirish
                    </button>
                </form>
                {% endif %}
            </div>
        </div>
    </div>
    {% empty %}
    <div class="empty-state">
        <div class="empty-state-icon">ğŸ”</div>
        <h4>Hech qanday ish topilmadi</h4>
        <p>Qidiruv natijasi bo'yicha ish e'lonlari mavjud emas</p>
    </div>
    {% endfor %}
</div>

{% endblock %}