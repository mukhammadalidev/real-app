{% extends 'base.html' %}

{% block content %}

<style>
    body {
        background: #fafafa !important;
        font-family: 'Inter', sans-serif;
    }

    .jobs-wrapper {
        max-width: 1000px;
        margin: auto;
    }

    /* Search Box */
    .search-box {
        background: #fff;
        border-radius: 18px;
        padding: 20px;
        border: 1px solid #ececec;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    }

    .search-box input {
        border: 1px solid #e0e0e0;
        border-radius: 12px;
        padding: 14px 18px;
        font-size: 15px;
        transition: .2s;
    }

    .search-box input:focus {
        border-color: #0d6efd;
        box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.1);
    }

    .search-box button {
        border-radius: 12px;
        padding: 14px 28px;
        font-weight: 600;
        font-size: 15px;
    }

    /* Results Header */
    .results-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 16px;
        padding: 20px 24px;
        margin-bottom: 24px;
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
    }

    .results-header h4 {
        margin: 0;
        font-weight: 700;
        font-size: 22px;
    }

    /* Job Card */
    .job-card {
        background: #fff;
        border-radius: 18px;
        padding: 24px;
        border: 1px solid #ececec;
        transition: all .3s ease;
        margin-bottom: 16px;
    }

    .job-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
        border-color: #0d6efd;
    }

    .job-title {
        font-weight: 700;
        font-size: 20px;
        color: #222;
        margin-bottom: 8px;
        line-height: 1.3;
    }

    .company-name {
        color: #6d7b91;
        font-size: 15px;
        font-weight: 500;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .location-text {
        color: #8b8b8b;
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 6px;
        margin-bottom: 12px;
    }

    .salary-badge {
        background: #d1f4e0;
        color: #0d9448;
        padding: 8px 16px;
        border-radius: 10px;
        font-weight: 600;
        font-size: 14px;
        display: inline-block;
    }

    /* Buttons */
    .btn-view {
        background: #0d6efd;
        color: white;
        border-radius: 10px;
        padding: 10px 22px;
        font-weight: 600;
        border: none;
        text-decoration: none;
        transition: .2s;
        font-size: 14px;
    }

    .btn-view:hover {
        background: #0b5ed7;
        color: white;
        transform: translateY(-2px);
    }

    .btn-delete {
        background: #fff;
        color: #dc3545;
        border: 2px solid #dc3545;
        border-radius: 10px;
        padding: 8px 18px;
        font-weight: 600;
        transition: .2s;
        font-size: 14px;
    }

    .btn-delete:hover {
        background: #dc3545;
        color: white;
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 60px 20px;
        background: #fff;
        border-radius: 18px;
        border: 1px solid #ececec;
    }

    .empty-state-icon {
        font-size: 64px;
        margin-bottom: 16px;
        opacity: 0.5;
    }

    .empty-state h4 {
        color: #6d7b91;
        font-weight: 600;
        margin-bottom: 8px;
    }

    .empty-state p {
        color: #8b8b8b;
        font-size: 15px;
    }

    /* Action buttons container */
    .action-buttons {
        display: flex;
        gap: 10px;
        align-items: center;
    }

    @media (max-width: 768px) {
        .job-card {
            padding: 20px;
        }

        .job-card>div {
            flex-direction: column !important;
            gap: 16px;
        }

        .action-buttons {
            justify-content: flex-start;
            width: 100%;
        }
    }
</style>

<div class="container py-5 jobs-wrapper">

    <!-- Search Bar -->
    <div class="search-box mb-4">
        <form method="GET" action="{% url 'search' %}">
            <div class="input-group">
                <input type="text" class="form-control border-end-0"
                    placeholder="üîç Kasb nomi, kompaniya yoki kalit so'z..." name="q" value="{{ query }}">
                <button class="btn btn-primary" type="submit">Qidirish</button>
            </div>
        </form>
    </div>

    <!-- Results Header -->
    <div class="results-header">
        <h4>üìã Natijalar: {{ jobs.count }} ta ish topildi</h4>
    </div>

    <!-- Job List -->
    {% for job in jobs %}
    <div class="job-card">
        <div class="d-flex justify-content-between align-items-start">

            <div class="flex-grow-1">
                <h5 class="job-title">{{ job.title|default:"Sarlovha mavjud emas"|truncatewords:10 }}</h5>

                <p class="company-name">
                    <svg width="16" height="16" fill="currentColor" class="bi bi-building" viewBox="0 0 16 16">
                        <path
                            d="M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1ZM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Z" />
                        <path
                            d="M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V1Zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3V1Z" />
                    </svg>
                    {{ job.employer.company_name }}
                </p>

                <p class="location-text">
                    <i class="bi bi-geo-alt-fill"></i> {{ job.location }}
                </p>

                <span class="salary-badge">
                    üí∞ {{ job.salary|default:"Kelishiladi" }}
                </span>
            </div>

            <div class="action-buttons">
                <a href="{% url 'job:job-detail' job.pk %}" class="btn-view">
                    Ko'rish ‚Üí
                </a>
                {% if request.user.is_superuser %}
                <form method="post" action="{% url 'job_delete' job.pk %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn-delete"
                        onclick="return confirm('Rostdan ham o\'chirmoqchimisiz?');">
                        O'chirish
                    </button>
                </form>
                {% endif %}
            </div>
        </div>
    </div>
    {% empty %}
    <div class="empty-state">
        <div class="empty-state-icon">üîç</div>
        <h4>Hech qanday ish topilmadi</h4>
        <p>Qidiruv natijasi bo'yicha ish e'lonlari mavjud emas</p>
    </div>
    {% endfor %}
</div>

{% endblock %}